<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>Petswale</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/petswaleyellowlogo.png') }}">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/product-detail.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/product-detail-review.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/footer.css') }}">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Open+Sans:wght@400&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet"/>
    
    <style>
        .product-info h1{
            font-weight: 500;
        }

        .product-meta-flex {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #222;
        }

        .price-rating-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            gap: 15px;
        }

        .price-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mrp-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .prices-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .product-price {
            font-size: clamp(1.4rem, 3vw, 1.8rem);
            color: #222;
            font-weight: 700;
            margin: 0;
        }

        .original-price {
            font-size: clamp(1rem, 2vw, 1.2rem);
            text-decoration: line-through;
            color: #999;
            margin: 0;
        }

        .discount-badge {
            background: #4caf50;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: clamp(0.7rem, 1.5vw, 0.8rem);
            font-weight: 600;
            white-space: nowrap;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            flex-shrink: 0;
        }

        .right-rating-stars {
            color: #ffc107;
            font-size: clamp(1rem, 2vw, 1.2rem);
        }

        .right-rating-count {
            font-size: clamp(0.85rem, 1.5vw, 0.95rem);
            color: #666;
        }

        .tax-info {
            font-size: 0.75rem;
            color: #666;
            align-self: flex-start;
        }

        .info {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2vh;
            margin-bottom: 4vh;
        }

        .delivery, .satisfaction, .safe-payment {
            border: 1px solid #ffca28;
            padding: 10px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.053);
            background: linear-gradient(145deg, #fff7e6, #fff); 
            gap: 1vh;
        }

        .delivery i, .satisfaction i, .safe-payment i {
            font-size: 24px;
            width: 35px;
            height: 35px;
            padding: 12px;
            background: linear-gradient(90deg, #ffca28, #ffb300);
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delivery p, .satisfaction p, .safe-payment p {
            font-weight: 900;
        }

        .product-image {
            flex: 1;
            order: 1;
            text-align: left;
            position: sticky;
            top: 20px;
            align-self: flex-start;
            z-index: 10;
        }

        @media (max-width: 768px) {
            .price-rating-container {
                flex-wrap: nowrap;
                gap: 10px;
            }

            .mrp-label {
                font-size: 0.75rem;
            }

            .product-price {
                font-size: clamp(1rem, 3vw, 1.2rem);
            }

            .original-price {
                font-size: clamp(0.8rem, 2vw, 0.95rem);
            }

            .discount-badge {
                font-size: 0.6rem;
                padding: 2px 5px;
            }

            .right-rating-stars {
                font-size: clamp(0.85rem, 2vw, 1rem);
            }

            .right-rating-count {
                font-size: clamp(0.7rem, 1.5vw, 0.8rem);
            }

            .product-image {
                position: relative;
                display: flex;
                flex-direction: column;
                align-items: center;
                text-align: center;
                flex: 1;
                justify-content: center;
                overflow: hidden;
                padding: 10px 20px;
                object-fit: contain;
                align-self: center;
            }
        }

        @media (max-width: 480px) {
            .price-wrapper {
                gap: 5px;
            }

            .mrp-label {
                font-size: 0.65rem;
            }

            .product-price {
                font-size: 0.95rem;
            }

            .original-price {
                font-size: 0.75rem;
            }

            .discount-badge {
                font-size: 0.55rem;
                padding: 2px 4px;
            }

            .right-rating-stars {
                font-size: 0.8rem;
            }

            .right-rating-count {
                font-size: 0.65rem;
            }

            .info {
                gap: 10px;
                padding: 10px;
                display: flex;
                flex-wrap: wrap;
                flex: 1;
            }

            .delivery, .satisfaction, .safe-payment {
                flex: 1;
                padding: 12px;
                height: 100px;
            }

            .delivery i, .satisfaction i, .safe-payment i {
                font-size: 18px;
                width: 35px;
                height: 35px;
                padding: 8px;
            }

            .delivery p, .satisfaction p, .safe-payment p {
                font-size: 10px;
            }
        }

        .related-products {
            padding: 15px;
            max-width: 1500px;
            margin: 0 auto;
            background: linear-gradient(135deg, #f5f7fa, #e8f0f5);
        }

        .product-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .product-list-header h2 {
            font-family: 'Poppins', sans-serif;
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            color: #222;
        }

        .product-header-controls {
            display: flex;
            flex-direction: row;
            gap: 8px;
            z-index: 8;
        }

        .product-header-control {
            background: #ffca28;
            color: #fff;
            border: none;
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: row;
        }

        .product-header-control:hover {
            background: #ffb300;
        }

        .product-header-control span.material-symbols-outlined {
            font-size: 1rem;
        }

        .product-slider {
            overflow: hidden;
        }

        .product-cards {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            scroll-behavior: smooth;
            padding-bottom: 10px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .product-cards::-webkit-scrollbar {
            display: none;
        }

        .related-products .product-card {
            background: #fff;
            border-radius: 10px;
            max-width: 250px;
            min-width: 200px;
            padding: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            flex: 0 0 calc(50% - 5px);
            overflow: hidden;
        }

        .related-products .product-card:hover {
            transform: scale(1.03);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .image-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .image-container img {
            width: 100%;
            height: 180px;
            object-fit: contain;
            border-radius: 8px;
        }

        .related-products .product-info {
            width: 100%;
            padding: 0 5px;
        }

        .related-products .product-info h3 {
            font-size: clamp(0.85rem, 1.8vw, 0.95rem);
            font-weight: 500;
            color: #333;
            line-height: 1.3;
            min-height: 35px;
            max-height: 40px;
            margin: 8px 0;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            word-break: break-word;
        }

        .related-products .product-price-rating {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            gap: 5px;
            padding: 0 5px;
            margin-bottom: 10px;
        }

        .related-products .price-container {
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            min-width: 0;
        }

        .related-products .current-price {
            font-size: clamp(0.9rem, 2vw, 1rem);
            color: #222;
            font-weight: 700;
            white-space: nowrap;
        }

        .related-products .original-price {
            font-size: clamp(0.7rem, 1.5vw, 0.8rem);
            color: #999;
            text-decoration: line-through;
            font-weight: 400;
            white-space: nowrap;
        }

        .related-products .product-rating {
            display: flex;
            align-items: center;
            gap: 2px;
            flex-shrink: 0;
        }

        .related-products .product-rating .stars {
            color: #ffc107;
            font-size: clamp(0.75rem, 1.5vw, 0.85rem);
            white-space: nowrap;
        }

        .related-products .rating-count {
            font-size: clamp(0.65rem, 1.3vw, 0.75rem);
            color: #666;
        }

        .related-products .product-actions {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            width: 100%;
            padding: 0 5px;
        }

        .related-products .add-to-cart,
        .related-products .add-to-wishlist {
            border: none;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: clamp(0.7rem, 1.4vw, 0.8rem);
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
        }

        .related-products .add-to-cart {
            background: #ffca28;
            color: #fff;
            border-radius: 20px;
            flex: 1;
            gap: 4px;
        }

        .related-products .add-to-cart:hover {
            background: #ffb300;
        }

        .related-products .add-to-wishlist {
            background: #f0f0f0;
            color: #ffca28;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            flex-shrink: 0;
        }

        .related-products .add-to-wishlist:hover,
        .related-products .add-to-wishlist.active {
            background: #ffca28;
            color: #fff;
        }

        .related-products .add-to-cart.added-to-cart.go-to-cart {
            background: #4caf50;
            color: #fff;
        }

        .review-item {
            background-color: #F9F9F9;
            padding: 10px 20px;
            border-radius: 10px;
            margin-bottom: 2vh;
        }

        @media (min-width: 768px) {
            .product-list-header {
                display: flex;
                flex-direction: row;
            }

            .related-products {
                padding: 20px;
            }

            .product-list-header h2 {
                font-size: clamp(1.5rem, 4vw, 2rem);
                margin-bottom: 20px;
            }

            .product-header-control {
                padding: 10px;
                display: flex;
                flex-direction: row;
            }

            .product-header-control span.material-symbols-outlined {
                font-size: 1.2rem;
            }

            .product-cards {
                gap: 15px;
            }

            .related-products .product-card {
                flex: 0 0 calc(25% - 11.25px);
                min-width: 220px;
            }

            .image-container img {
                height: 220px;
            }

            .related-products .add-to-cart,
            .related-products .add-to-wishlist {
                font-size: clamp(0.75rem, 1.5vw, 0.85rem);
            }
        }

        @media (max-width: 480px) {
            .related-products {
                padding: 10px;
                margin: 15px 0;
            }

            .related-products h2 {
                font-size: clamp(1.1rem, 4vw, 1.3rem);
            }

            .product-list-header {
                display: flex;
                flex-direction: row;
            }

            .product-header-control {
                padding: 6px;
            }

            .product-actions {
                display: flex;
                flex-direction: row;
            }

            .cart-txt {
                display: none;
            }

            .product-header-control span {
                font-size: 16px;
            }

            .related-products .product-card {
                flex: 0 0 calc(60% - 5px);
                min-width: 180px;
                max-width: 220px;
            }

            .related-products .product-price-rating {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
            }

            .related-products .price-container {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                gap: 2px;
                flex: 1;
            }

            .related-products .current-price {
                font-size: 1rem;
                font-weight: 700;
            }

            .related-products .original-price {
                font-size: 0.75rem;
            }

            .related-products .product-rating {
                display: flex;
                flex-direction: column;
                align-items: flex-end;
                gap: 2px;
            }

            .related-products .product-rating .stars {
                font-size: 0.8rem;
            }

            .related-products .rating-count {
                font-size: 0.65rem;
            }

            .related-products .add-to-cart {
                height: 35px;
                padding: 6px 8px;
            }

            .related-products .add-to-wishlist {
                width: 32px;
                height: 32px;
            }

            .image-container img {
                height: 160px;
            }
        }

        @media (max-width: 400px) {
            .product-list-header h2 {
                font-size: 0.95rem !important;
            }
            .product-list-header {
                gap: 2px;
            }
            .product-header-controls {
                flex-shrink: 1;
            }
        }
    </style>
</head>
<body>
<script>window.isAuthenticated = {{ 'true' if current_user.is_authenticated else 'false' }};</script>
    {% include 'navbar.html' %}
    <div class="product-detail-section">
        <div class="product-container">
            <div class="product-image">
                <div class="image-nav">
                    <button class="image-nav-btn prev"><span class="material-symbols-outlined">arrow_back_ios</span></button>
                    <button class="image-nav-btn next"><span class="material-symbols-outlined">arrow_forward_ios</span></button>
                </div>
                <div class="main-img">
                    <img id="main-product-image" src="{{ product.image_url }}" alt="{{ product.name }}">
                </div>
                <div class="image-gallery">
                    <div class="thumbnail active" data-image-url="{{ product.image_url }}">
                        <img src="{{ product.image_url }}" alt="Main Thumbnail">
                    </div>
                    {% for image in additional_images %}
                        <div class="thumbnail" data-image-url="{{ image.image_url }}">
                            <img src="{{ image.image_url }}" alt="Thumbnail">
                        </div>
                    {% endfor %}
                </div>
            </div>
            
            <div class="product-right-section">
                <div class="product-info">
                    <h1>{{ product.name }}</h1>
                    
                    <!-- ✅ UPDATED: Price left with discount badge, stars right, tax below -->
                    <div class="product-meta-flex">
                        <div class="price-rating-container">
                            <div class="price-wrapper">
                                <span class="mrp-label">MRP:</span>
                                <div class="prices-group">
                                    {% if product.discount_price and product.discount_price < product.price %}
                                        <p class="product-price">₹{{ "%.2f"|format(product.discount_price) }}</p>
                                        <p class="original-price">₹{{ "%.2f"|format(product.price) }}</p>
                                        {% set discount_percent = ((product.price - product.discount_price) / product.price * 100) | int %}
                                        <span class="discount-badge">{{ discount_percent }}% OFF</span>
                                    {% else %}
                                        <p class="product-price">₹{{ "%.2f"|format(product.price) }}</p>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="product-rating">
                                <span class="stars right-rating-stars">
                                    {% for i in range(5) %}
                                        {% if i < avg_rating|int %}★{% else %}☆{% endif %}
                                    {% endfor %}
                                </span>
                                <span class="rating-count right-rating-count">({{ total_reviews }})</span>
                            </div>
                        </div>
                        <div class="tax-info">*inclusive of all taxes</div>
                    </div>
                </div>
               
                <div class="weight-quantity-stock">
                    {% if product.category.name == 'Food' and variants|length > 1 %}
                    <div class="qty-btn-container">
                        <p>Variants: </p>
                        <div class="qty-btns">
                            {% for variant in variants %}
                                <button
                                    class="qty-btn{% if variant.id == selected_variant.id %} selected{% endif %}"
                                    onclick="window.location.href='{{ url_for('main.product_detail', product_id=variant.id) }}'"
                                    {% if variant.id == selected_variant.id %}disabled{% endif %}
                                >
                                    {{ variant.weight|int if variant.weight == variant.weight|int else variant.weight }}
                                </button>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <div class="quantity-stock-row">
                        <p>Quantity:</p>
                        <div class="quantity-selector">
                            <button class="quantity-btn decrease">-</button>
                            <input type="number" class="quantity-input" value="1" min="1" max="{{ product.stock }}">
                            <button class="quantity-btn increase">+</button>
                        </div>
                        {% if product.stock > 0 %}
                            <p class="product-stock in-stock"><span class="material-symbols-outlined">inventory_2</span> In Stock ({{ product.stock }} available)</p>
                        {% else %}
                            <p class="product-stock out-of-stock"><span class="material-symbols-outlined">cancel</span> Out of Stock</p>
                        {% endif %}
                    </div>
                </div>
                
                <div class="product-action">
                    <button id="add-to-cart-btn" class="add-to-cart" data-product-id="{{ product.id }}">
                        <span class="material-symbols-outlined">shopping_cart</span>
                        <p class="cart-txt">Add to Cart</p>
                    </button>
                    <button id="add-to-wishlist-btn" class="add-to-wishlist" data-product-id="{{ product.id }}">
                        <span class="material-symbols-outlined">favorite</span>
                        <span class="wishlist-txt">Add to Wishlist</span>
                    </button>
                </div>

                <div class="info">
                    <div class="delivery"><i class="ri-truck-line"></i> <p>Fast Delivery!</p></div>
                    <div class="satisfaction"><i class="ri-user-heart-line"></i> <p>Guaranteed Satisfaction</p></div>
                    <div class="safe-payment"><i class="ri-secure-payment-fill"></i> <p>Secure Payment</p></div>
                </div>
              
                <div class="product-description">
                    <div class="tabs">
                        <div class="tab active" data-tab="description">Details</div>
                        <div class="tab" data-tab="additional-info">Additional Info</div>
                        <div class="tab" data-tab="food-features">Food Features</div>
                    </div>
                    <div id="description" class="tab-content active">
                        <p>{{ product.description or 'No product description available.' }}</p>
                        <p>{{ product.category.description or 'No category description available.' }}</p>
                    </div>
                    <div id="additional-info" class="tab-content">
                        <h2>Additional Information</h2>
                        {% if attributes %}
                            <table class="specs-table">
                                {% for attr in attributes %}
                                    <tr>
                                        <th>{{ attr.key }}</th>
                                        <td>{{ attr.value }}</td>
                                    </tr>
                                {% endfor %}
                            </table>
                        {% else %}
                            <p>No additional information available.</p>
                        {% endif %}
                    </div>
                    <div id="food-features" class="tab-content">
                        {% if product.category.description %}
                            <h2>{{ product.category.name }} Features</h2>
                            <p>{{ product.category.description }}</p>
                        {% else %}
                            <h2>Product Highlights</h2>
                            <p>{{ product.description|default('Explore this amazing product for your pet!', true) }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ✅ FIXED: Related Products Section -->
    <div class="related-products">
        <div class="product-list-header">
            <h2>You May Also Like</h2>
            <div class="product-header-controls">
                <button class="product-header-control prev"><span class="material-symbols-outlined">arrow_back_ios</span></button>
                <button class="product-header-control next"><span class="material-symbols-outlined">arrow_forward_ios</span></button>
            </div>
        </div>
        <div class="product-slider">
            <div class="product-cards" id="recommended-products">
                {% for product in recommended_products %}
                    <div class="product-card" data-product-id="{{ product.id }}">
                        <div class="image-container">
                            <img src="{{ product.image_url }}" alt="{{ product.name }}">
                        </div>
                        <div class="product-info">
                            <h3 title="{{ product.name }}">{{ product.name }}</h3>
                        </div>
                        
                        <!-- ✅ FIXED: Price left, stars right - all within card -->
                        <div class="product-price-rating">
                            <div class="price-container">
                                {% if product.discount_price and product.discount_price < product.price %}
                                    <span class="current-price">₹{{ "%.2f"|format(product.discount_price) }}</span>
                                    <span class="original-price">₹{{ "%.2f"|format(product.price) }}</span>
                                {% else %}
                                    <span class="current-price">₹{{ "%.2f"|format(product.price) }}</span>
                                {% endif %}
                            </div>
                            
                            <div class="product-rating">
                                {% set avg_rating = (product.reviews|map(attribute='rating')|sum / product.reviews|length)|round(1) if product.reviews else 0 %}
                                <span class="stars">
                                    {% for i in range(5) %}
                                        {% if i < avg_rating|int %}★{% else %}☆{% endif %}
                                    {% endfor %}
                                </span>
                                <span class="rating-count">({{ product.reviews|length }})</span>
                            </div>
                        </div>
                        
                        <div class="product-actions">
                            <button class="add-to-cart" data-product-id="{{ product.id }}">
                                <span class="material-symbols-outlined">add_shopping_cart</span> 
                                <p class="cart-txt">Add to Cart</p>
                            </button>
                            <button class="add-to-wishlist" data-product-id="{{ product.id }}">
                                <span class="material-symbols-outlined">favorite</span>
                            </button>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    
    <div class="customer-reviews-section">
        <h2>Customer Reviews</h2>
        <div class="review-summary">
            <div class="average-rating">
                <p class="rating-value">{{ avg_rating }}</p>
                <span class="stars">
                    {% for i in range(5) %}
                        {% if i < avg_rating|int %}★{% else %}☆{% endif %}
                    {% endfor %}
                </span>
                <p class="total-reviews">({{ total_reviews }} customer {{ 'review' if total_reviews == 1 else 'reviews' }})</p>
            </div>
            <div class="rating-bars">
                {% for i in range(5, 0, -1) %}
                    <div class="rating-bar">
                        <p class="rating-label">{{ i }} Stars</p>
                        <div class="rating-progress">
                            <div class="rating-progress-fill" style="width: {{ (rating_counts[i] / total_reviews * 100) if total_reviews > 0 else 0 }}%"></div>
                        </div>
                        <p class="rating-count">{{ rating_counts[i] }}</p>
                    </div>
                {% endfor %}
            </div>
        </div>
        <div class="review-list">
            {% for review in reviews %}
                <div class="review-item">
                    <div class="review-header">
                        <div class="name-rating">
                            <p class="reviewer-name">{{ review.reviewer.username }}</p>
                            <div class="review-rating">
                                <span class="stars">
                                    {% for i in range(5) %}
                                        {% if i < review.rating %}★{% else %}☆{% endif %}
                                    {% endfor %}
                                </span>
                            </div>
                        </div>
                        <div class="date">
                            <p class="review-date">{{ (review.updated_at or review.created_at).strftime('%B %d, %Y') }}</p>
                        </div>
                    </div>
                    <p class="review-content">{{ review.content }}</p>    
                </div>
            {% else %}
                <p>No reviews yet. Be the first to review this product!</p>
            {% endfor %}
        </div>
        {% if current_user.is_authenticated %}
            <div class="add-review-section">
                <h2>Add a Review</h2>
                <form id="review-form" data-product-id="{{ product.id }}">
                    <div class="form-group">
                        <label for="rating">Your Rating *</label>
                        <div class="rating-select">
                            {% for i in range(1, 6) %}
                                <input type="radio" name="rating" id="rating-{{ i }}" value="{{ i }}" required>
                                <label for="rating-{{ i }}">
                                    <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                                </label>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="review-content">Your Review *</label>
                        <textarea id="review-content" name="content" required></textarea>
                    </div>
                    <button type="submit" class="submit-review">
                        <span class="material-symbols-outlined">rate_review</span> Submit Review
                    </button>
                </form>
            </div>
        {% else %}
            <p>Please <a href="{{ url_for('main.signin') }}">login</a> to write a review.</p>
        {% endif %}
    </div>
    
    {% include 'footer.html' %}
    <nav class="mobile-bottom-nav">
        <a href="{{ url_for('main.home') }}" class="{% if request.endpoint == 'main.home' %}active{% endif %}">
            <span class="material-symbols-outlined">home</span>
            <span>Home</span>
        </a>
        <a href="{{ url_for('main.search') }}" class="{% if request.endpoint == 'main.search' %}active{% endif %}">
            <span class="material-symbols-outlined">search</span>
            <span>Search</span>
        </a>
        <a href="{{ url_for('main.wishlist') }}" class="{% if request.endpoint == 'main.wishlist' %}active{% endif %}">
            <span class="material-symbols-outlined">favorite</span>
            <span>Wishlist</span>
        </a>
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('main.profile') }}" class="{% if request.endpoint == 'main.profile' %}active{% endif %}">
                <span class="material-symbols-outlined">person</span>
                <span>Profile</span>
            </a>
        {% else %}
            <a href="{{ url_for('main.signin') }}" class="{% if request.endpoint == 'main.signin' %}active{% endif %}">
                <span class="material-symbols-outlined">login</span>
                <span>Login</span>
            </a>
        {% endif %}
    </nav>
    <script src="{{ url_for('static', filename='js/product-detail.js') }}"></script>
    <script src="{{ url_for('static', filename='js/login-notification.js') }}"></script>
</body>
</html>